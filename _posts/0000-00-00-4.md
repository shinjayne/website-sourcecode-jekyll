---
#default
layout : post
title : "Scala ì˜ Type Class ì½”ë“œë¡œ ì‚´í´ë³´ê¸° 2"
date : 2017-06-29 00:46:40 +0900
categories : scala
tags : scala

#custom
post_id : 4
permalink : "/post/4"
imageurl : "/asset/media/image/post/4"
mainpic : "/asset/media/image/post/3/scala-icon.png"
---

# 1. Turning Type Classes into OO Classes
<br/>
<br/>
<br/>


```scala211
abstract class Iter[I,A]{
    def getValue(i : I) : Option[A]
    def getNext(i : I) : I
}
```




    defined [32mclass[39m [36mIter[39m




```scala211
implicit def ListIter[A] : Iter[List[A], A] = new Iter[List[A], A]{
    def getValue(i : List[A]) : Option[A] = i.headOption
    def getNext( i : List[A]) : List[A] = i.tail
}
```




    defined [32mfunction[39m [36mListIter[39m




```scala211
def sumElements[I](xs : I)(implicit proxy : Iter[I, Int]) : Int = proxy.getValue(xs) match{
    case None => 0
    case Some(n) => n + sumElement(proxy.getNext(xs))
}

def printElements[I, X](xs : I)(implicit proxy : Iter[I, X]) : Unit = proxy.getValue(xs) match{
    case None =>
    case Some(n) => {println(n) ; printElements(proxy.getNext(xs)) ; }
}
```




    defined [32mfunction[39m [36msumElements[39m
    defined [32mfunction[39m [36mprintElements[39m




```scala211
val I = List(3, 4, 5, 1)
sumElements(I)
printElements(I)
```

    3
    4
    5
    1





    [36mI[39m: [32mList[39m[[32mInt[39m] = [33mList[39m([32m3[39m, [32m4[39m, [32m5[39m, [32m1[39m)
    [36mres5_1[39m: [32mInt[39m = [32m13[39m




```scala211
import scala.language.higherKinds
import scala.language.implicitConversions

abstract class Dyn2[S[_,_], A]{
    type Data
    val d: Data
    val i : S[Data, A]
}

object Dyn2 {
    // ì‹¤ì œ ë™ì‘ í•¨ìˆ˜. ii ì— incIter ë™ì‘ ì¸ìŠ¤í„´ìŠ¤ê°€ ë“¤ì–´ê°€ê³ 
    implicit def apply[S[_,_],D,A](dd : D)(implicit ii : S[D,A]) : Dyn2[S,A] = new Dyn2[S,A]{
        type Data = D
        val d : Data = dd
        val i : S[Data, A] = ii
    }
    implicit def methods[S[_,_], A](d : Dyn2[S,A]) : S[d.Data, A] = d.i
}


/*********************************************************************
<<  Dyn2 ì¸ìŠ¤í„´ìŠ¤ ëŠ” <íƒ€ì…í´ë˜ìŠ¤ ì •ë³´ S > <ë°˜í™˜í•  ë°ì´í„° íƒ€ì… A> ë¡œ ì´ˆê¸°í™”í•˜ê³   
    <íƒ€ì… í´ë˜ìŠ¤ê°€ ë‹¤ë£° ë°ì´í„° êµ¬ì¡° D>ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤.    >>>   

    val  x : Dyn2[S,A](D)  >>>  x.d = ë°ì´í„°êµ¬ì¡° (ì£¼ì¸ê³µ)  
                                    x.i = íƒ€ì…í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì •ë³´( ì‹¤í–‰ê¸° )

    <Dyn2 ì¸ìŠ¤í„´ìŠ¤ x> ë¥¼ ë§Œë“¤ë©´ ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ê°€?
    x : Dyn2[Iter, Int]  =  Dyn2(List(1,2,3))   
    y : Dyn2[Iter, Int]  = Dyn2(MyNode(1, Empty(), Empty()))   
    ê°ê°ì˜ x, y ì— ì•ˆì— ë“¤ì–´ìˆëŠ” ë°ì´í„°êµ¬ì¡°ì™€ íƒ€ì…í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì •ë³´ë¡œ, Iter íƒ€ì…í´ë˜ìŠ¤ë¡œ êµ¬í˜„ëœ ë©”ì„œë“œë¥¼ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

    Iter type class ì˜  interface methodÂ ë“¤

    sumElements(x.d)(x.i)
    printElements(y.d)(y.i)




***********************************************************************/
```




    [32mimport [39m[36mscala.language.higherKinds
    [39m
    [32mimport [39m[36mscala.language.implicitConversions

    [39m
    defined [32mclass[39m [36mDyn2[39m
    defined [32mobject[39m [36mDyn2[39m




```scala211
// type class ì¸ìŠ¤í„´ìŠ¤  .... Int ë°ì´í„°êµ¬ì¡° ë“¤ì–´ì™”ì„ë•Œ  ë™ì‘ì„ ê¸°ìˆ í•¨ ... í•˜ì§€ë§Œ ì§ì ‘ ë„£ì–´ì¤„ ê²ƒì´ê¸° ë•Œë¬¸ì— implicit ì ì§€ ì•Šì•˜ë‹¤.
def incIter(max : Int) : Iter[Int, Int] = new Iter[Int, Int] {
    def getValue(i : Int) = if (i <= max) Some(i) else None
    def getNext(i : Int) = i + 1
}

// Dyn2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ë‚´ëŠ” ë°©ë²•
// getMyIter
def getMyIter(isInc: Boolean) : Dyn2[Iter, Int] = { //Dyn2[Iter, Int] ë¡œ ì´ˆê¸°í™”í•œë‹¤.
    if (isInc) Dyn2(0)(incIter(10)) //Dyn2.apply(0)(incIter(10))   // Dyn2(0) Intë¼ëŠ” ë°ì´í„°êµ¬ì¡° ë¥¼ ë‹¤ë£¬ë‹¤.
    else List(3, 1, 5)  // Dyn2.apply(List(3,1,5))(listIter[Int])   // Dyn2(List[Int])   List[Int] ë¼ëŠ” ë°ì´í„°êµ¬ì¡°ë¥¼ ë‹¤ë£¬ë‹¤.
}
```




    defined [32mfunction[39m [36mincIter[39m
    defined [32mfunction[39m [36mgetMyIter[39m




```scala211
val i1  : Dyn2[Iter, Int] = getMyIter(true)
printElements(i1.d)(i1.i)  //printElements(0)(incIter(10))

val i2 : Dyn2[Iter, Int] = getMyIter(false)
printElements(i2.d)(i2.i) //printElements()
```

    0
    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    3
    1
    5





    [36mi1[39m: [32mDyn2[39m[[32mIter[39m, [32mInt[39m] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@74086131
    [36mi2[39m: [32mDyn2[39m[[32mIter[39m, [32mInt[39m] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@67d4c1f6




```scala211
abstract class Dyn[T[_]]{
    type Data
    val d : Data
    val proxy : T[Data]
}

object Dyn{
    implicit def apply[D, T[_]](dd : D)(implicit tt : T[D]) : Dyn[T] = new Dyn[T] {

        type Data = D
        val d : Data = dd
        val proxy : T[D] = tt

    }
}


```




    defined [32mclass[39m [36mDyn[39m
    defined [32mobject[39m [36mDyn[39m




```scala211
// ë°ì´í„° êµ¬ì¡° ì •ë³´

sealed abstract class MyTree[A]
case class Empty[A]() extends MyTree[A]
case class Node[A](value : A, left : MyTree[A], right : MyTree[A]) extends MyTree[A]
```




    defined [32mclass[39m [36mMyTree[39m
    defined [32mclass[39m [36mEmpty[39m
    defined [32mclass[39m [36mNode[39m



# type class ë³¸ì²´


```scala211
// ë°ì´í„° êµ¬ì¡° R ë¥¼ ë‹¤ë£¨ëŠ” type class ë³¸ì²´  
// iter ë©”ì„œë“œëŠ” Dyn2
abstract class Iterable[R,A]{
    def iter(a: R) : Dyn2[Iter , A] // ë°ì´í„°êµ¬ì¡° R ì„ ë„£ìœ¼ë©´ R ì„ ë‹¤ë£¨ëŠ” Dyn2[Iter, A](R) ë¥¼ ëŒë ¤ì¤„ ê²ƒì´ë‹¤.
}
```




    defined [32mclass[39m [36mIterable[39m



# type class ì¸ìŠ¤í„´ìŠ¤


```scala211
implicit def treeIterable : Iterable[MyTree[Int], Int] = new Iterable[MyTree[Int], Int]{
    def iter(a : MyTree[Int]) : Dyn2[Iter, Int] = {
        def go(I : MyTree[Int]) : List[Int] = I match{
            case Empty() => Nil
            case Node(v, left, right) => v :: (go(left) ++ go(right))
        }
        go(a)   // List[Int]   --> Dyn2[Iter, Int](List[Int]) --> Dyn2[Iter,Int](List[Int])(listIter(List[Int], Int))
    }
}
```




    defined [32mfunction[39m [36mtreeIterable[39m



# type class ì¸í„°í˜ì´ìŠ¤ (ì‚¬ìš©)


```scala211
def sumElements2[R](xs : R)(implicit proxy : Iterable[R, Int]) = {
    val cs = proxy.iter(xs)  // Dyn2[Iter, Int](Iter ë¡œ ë‹¤ë£°ìˆ˜ ìˆê²Œ ë³€í˜•ëœ xs)
    sumElements(cs.d)(cs.i)
}
```




    defined [32mfunction[39m [36msumElements2[39m




```scala211
val t : MyTree[Int] = Node(1, Empty(), Empty())
sumElements2(t)
```




    [36mt[39m: [32mMyTree[39m[[32mInt[39m] = Node(1,Empty(),Empty())
    [36mres22_1[39m: [32mInt[39m = [32m1[39m




```scala211

```
